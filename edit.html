<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Debate Editor</title>
<style>
body { font-family: Arial, sans-serif; background: #1e1e1e; color: #fff; padding:20px;}
h1 { color: #00ffcc; }
input, button { padding: 10px; margin: 5px 0; font-size: 16px; }
button { cursor: pointer; background: #00ffcc; border: none; color: #000; font-weight: bold; }
button.delete { background: #ff5555; color: #fff; margin-left: 10px; }
#questions { margin-top: 20px; }
.question { background: #252526; padding: 10px; margin-bottom: 5px; border-radius: 5px; display:flex; justify-content: space-between; align-items: center;}
.vote-bar { background:#00ffcc; height: 20px; border-radius: 5px; margin-top:5px; transition: width 0.3s;}
</style>
</head>
<body>
<h1>Admin: Edit Debate Questions</h1>
<input type="text" id="newQuestion" placeholder="Enter new question">
<button onclick="addQuestion()">Add Question</button>

<div id="questions"></div>

<script>
async function fetchQuestions() {
    const res = await fetch('/questions');
    const data = await res.json();
    const container = document.getElementById('questions');
    container.innerHTML = '';
    data.questions.forEach(q => {
        const div = document.createElement('div');
        div.className = 'question';
        div.innerHTML = `
            <span>${q.text}</span>
            <div>
                Votes: ${q.votes} 
                <div class="vote-bar" style="width:${q.votes * 20}px;"></div>
                <button class="delete" onclick="deleteQuestion('${q.id}')">Delete</button>
            </div>
        `;
        container.appendChild(div);
    });
}

async function addQuestion() {
    const question = document.getElementById('newQuestion').value;
    if(!question) return;
    await fetch('/add-question', {
        method: 'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ question })
    });
    document.getElementById('newQuestion').value = '';
    fetchQuestions();
}

async function deleteQuestion(id) {
    if(!confirm('Are you sure you want to delete this question?')) return;
    await fetch('/delete-question', {
        method: 'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ id })
    });
    fetchQuestions();
}

// Live update every 2 seconds
fetchQuestions();
setInterval(fetchQuestions, 2000);
</script>
</body>
</html>
